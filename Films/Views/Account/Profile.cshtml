@using Films.Models.APIModels
@model Films.Models.ViewModels.UserProfileViewModel

@{
    <link rel="stylesheet" href="~/css/profileDashboard.css" />
}

<div class="profile-wrapper container mt-5 d-flex flex-wrap justify-content-evenly">
    <!-- SECCIÓN IZQUIERDA -->
    <aside class="profile-sidebar column justify-content-center mb-5 text-center">
        <div class="col-12 col-md-12">
            <div class="profile-picture">
                <img src="@Model.User.Image" alt="Foto de perfil" class="rounded-circle img-fluid mb-3" />
                <h2>@Model.User.Username</h2>
            </div>
        </div>

        <!-- SECCIÓN DE LISTAS -->
        <div class="list-section col-12 col-md-12 mt-4">
            <h3 style=" color: #F4C430;" class="section-title">Mis Listas</h3>
            @if (Model.TypeLists != null)
            {
                foreach (var type in Model.TypeLists)
                {
                    // Buscar listas asociadas a este tipo
                    var listsOfType = Model.User.Lists?.Where(l => l.FkIdTypeList == type.IdListType);

                    string iconClass = type.IdListType switch
                    {
                        1 => "fa-hourglass-half",
                        2 => "fa-check",
                        3 => "fa-heart",
                        4 => "fa-trash-can",
                        _ => "fa-list"
                    };

                    <div class="list-item">
                        <a asp-controller="Movies" asp-action="ViewList" asp-route-id="@type.IdListType">
                            <i class="fa-solid @iconClass"></i> @type.ListName
                        </a>
                        @if (listsOfType != null && listsOfType.Any())
                        {
                            <span class="badge bg-success ms-2">@listsOfType.Count() películas</span>
                        }
                        else
                        {
                            <span class="badge bg-secondary ms-2">Sin contenido</span>
                        }
                    </div>
                }
            }
            else
            {
                <p>No tienes listas disponibles.</p>
            }
        </div>
    </aside>

    <!-- SECCIÓN DERECHA -->
    <main class="profile-main">
        <!-- AMIGOS -->
        <div class="friends-header">
            <h3 style="color: #F4C430">Amigos</h3>
            @if (Model.User.FriendFkIdFriendNavigations != null && Model.User.FriendFkIdFriendNavigations.Any())
            {
                foreach (var friend in Model.User.FriendFkIdFriendNavigations)
                {
                    <p>@friend.FkIdFriendNavigation.Username</p>
                }
            }
            else
            {
                <p>No tienes amigos aún.</p>
            }
        </div>

        <!-- SOBRE MÍ -->
        <div class="about-me mt-5">
            <h3 style=" color: #F4C430;">Sobre mí</h3>
            <p>@Model.User.AboutMe</p>
        </div>

        <!-- COMENTARIOS -->
        <div class="comments-section mt-5">
            <h3 style=" color: #F4C430;">Mis Comentarios</h3>
            @if (Model.User.Reviews != null && Model.User.Reviews.Any())
            {
                foreach (var review in Model.User.Reviews)
                {
                    <div class="comment-item">
                        <h4>@review.Title</h4>
                        <div class="rating">
                            @for (int i = 0; i < review.Rating; i++)
                            {
                                <span>&#9733;</span>
                            }
                        </div>
                        <p>@review.Description</p>
                    </div>
                }
            }
            else
            {
                <p>No has hecho ningún comentario.</p>
            }
        </div>
    </main>
</div>





